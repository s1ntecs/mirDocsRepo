---
id: forms
title: Формы
---
# Работа с объектами

выфвфыапыипждиафыжвпиаи

## Создание Объекта

### Работа с формой "Создание Объекта"
![Скриншот программы](./img/createObjForm.png "Скриншот программы")
### Описание

Форма "Создание Объекта" предназначена для добавления новых объектов в систему. Она включает ввод данных, выбор параметров объекта и размещение его на соответствующем листе Excel. Форма обрабатывает объекты различных типов, таких как Исток, НПС, Труба и другие.

### Основные функции формы

#### 1. Инициализация формы

При открытии формы вызывается метод `Userform_initialize`, который:

- Очищает поля ввода.
- Устанавливает значения по умолчанию.
- Заполняет выпадающие списки (`GroupComboBox`, `RegionComboBox`) доступными типами и регионами.

#### 2. Поля формы

- **`objectNameBox`**: текстовое поле для ввода названия объекта.
- **`GroupComboBox`**: выбор группы объекта (например, Исток, НПС, ЦПС).
- **`ModelComboBox`**: выбор модели объекта на основе группы.
- **`RegionComboBox`**: выбор региона объекта.
- **`OwnerTextBox`**: текстовое поле для ввода владельца объекта.
- **`ObjectCost`**: поле для отображения стоимости объекта.
- **`IsNewOptionCheckBox`**: флажок для выбора нового объекта (включает возможность указания стоимости).

#### 3. Кнопки формы

- **`CreateObject`**: добавляет объект с указанными параметрами в систему.
- **`GetPriceButton`**: открывает форму для ввода стоимости объекта.
- **`importFromDB`**: импортирует данные из БД Источников.
- **`importInfraObjectFromDB`**: импортирует данные из БД Инфраструктуры.
- **`EmptyTube`**: создаёт пустую линию (например, для трубопровода).

### Логика работы

#### 1. Инициализация

Форма заполняет выпадающие списки:

```vba
Private Sub Userform_initialize()
    With GroupComboBox
        .AddItem "Исток"
        .AddItem "НП"
        ' Добавляются другие группы...
    End With

    With RegionComboBox
        .AddItem "00"
        .AddItem "ВСТО"
        ' Добавляются регионы...
    End With
End Sub
```

Если объект уже выбран, данные заполняются из глобальных переменных.

#### 2. Создание объекта

Метод `CreateObject_Click`:

1. Проверяет, заполнены ли все обязательные поля.
2. Указывает местоположение объекта или линии на листе Excel с помощью `Application.InputBox`.
3. Добавляет данные на листы `МТБ` или `Карта`.
4. Создаёт графическое представление объекта через `CreateShape`.

Основные шаги:

```vba
If modelType = "Труба" Then
    Set selectedCell = Application.InputBox("Укажите начало линии", Type:=8)
    Set selectedSecondCell = Application.InputBox("Укажите конец линии", Type:=8)
Else
    Set selectedCell = Application.InputBox("Укажите ячейку для фигуры", Type:=8)
End If
```

#### 3. Импорт данных

- Кнопка **`importFromDB`**: Импортирует данные из БД Источников. После импорта данные отображаются в соответствующих полях формы.
- Кнопка **`importInfraObjectFromDB`**: Импортирует данные из БД Инфраструктуры, включая тип, регион и владельца.

#### 4. Обработка графического интерфейса

Метод `CreateShape` создаёт фигуру на листе:

- Для объекта — прямоугольник.
- Для трубопровода — линия с заданными координатами.
- Объект привязывается к данным на листе.

### Взаимодействие с листами Excel

#### 1. Лист `МТБ`

Хранит основную информацию об объектах:

- Тип объекта.
- Название.
- Группа.
- Регион.
- Владелец.

#### 2. Лист `Карта`

Хранит графическое представление объектов и их взаимосвязей.

#### 3. Лист `Источ`

Используется для хранения профилей.

### Пример использования

1. Запустите форму.
2. Укажите данные объекта:
   - Название, тип, регион и владельца.
3. Нажмите **"Создать"**.
4. Выберите ячейку на листе, где разместить объект.
5. Объект добавится в таблицу и отобразится на листе в графическом виде.

### Возможные доработки

- Добавить обработку для специфических типов объектов.
- Реализовать проверку уникальности объекта перед созданием.
- Оптимизировать заполнение выпадающих списков (например, из базы данных).



## Вставить объект

- Установите приложение.
- Зарегистрируйтесь в системе.

## Обновить профиль Источника

- Настройте параметры.
- Запустите процесс.

## Обновление данных с БД
 Для обновления данных из БД ест ь разные способы:
    - форма обновления Инсфра объектов
    - форма 
### Вставить объект из БД Инфраструктуры

### пафоыипжои

лопиаыижфиэипфыаэдл

### Вставить Источник из БД Источников

### Обновить объект из БД Инфраструктуры

### Обновить Источник из БД Источников

## Диспетчер объектов

## Диаграммы

### Нарисовать диаграмму объекта с распределением по Источникам

### Нарисовать диаграмму цепочки объектов с распределением по Источникам
